<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>PoseNet using p5.js</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
    <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js" type="text/javascript"></script>
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>-->
    <script>
      function sendPoses() {
        if (poses.length != 0){
          var data = JSON.stringify(poses[0]['pose']);
          let socket = new WebSocket("ws://localhost:8000");
          socket.onopen = function(e) {
            socket.send(JSON.stringify(data))
          };
        }
      }
      var interval = 100;
      setInterval(sendPoses, interval);
    </script>

    <script>
      function sendSound() {
        if (label.length != 0){
          var data = JSON.stringify(label)
          let socket = new WebSocket("ws://localhost:8010");
          socket.onopen = function(e) {
            socket.send(JSON.stringify(data))
          };
          var conf  = JSON.stringify(label[0]['confidence']*100)
          document.getElementById("soundLabel").innerHTML = "Sound detected: "+JSON.stringify(label[0]['label'])+" , Confidence: "+conf.substring(0,5)+" %"; // 6.7;
          console.log(label)
        }
      }
      //var interval = 500;
      var interval = 100;
      setInterval(sendSound, interval);
    </script>

  <body>
    <p id='status'>Loading model...</p>
    <div id="soundLabel"></div>
    <script src="sketch.js"></script>
  </body>
</html>